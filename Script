// main.js â€” Optimizado para Nonoalko ðŸ’¥

document.addEventListener('DOMContentLoaded', () => {
  const body = document.body;

  // ðŸŒ— Alternador de tema con preferencia guardada
  const btnTema = document.querySelector('#modo-tema');
  const temaGuardado = localStorage.getItem('tema');
  const usaModoOscuro = temaGuardado === 'oscuro' || (!temaGuardado && window.matchMedia('(prefers-color-scheme: dark)').matches);
  
  if (usaModoOscuro) {
    body.classList.add('modo-oscuro');
  }

  if (btnTema) {
    btnTema.addEventListener('click', () => {
      const activado = body.classList.toggle('modo-oscuro');
      localStorage.setItem('tema', activado ? 'oscuro' : 'claro');
    });
  }

  // Scroll suave entre secciones
  const enlacesInternos = document.querySelectorAll('a[href^="#"]');
  enlacesInternos.forEach(enlace => {
    enlace.addEventListener('click', e => {
      const destino = document.querySelector(enlace.getAttribute('href'));
      if (destino) {
        e.preventDefault();
        destino.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });

  // GalerÃ­a responsiva con columnas segÃºn tamaÃ±o
  function ajustarGaleria() {
    const galeria = document.querySelector('.gallery');
    if (galeria) {
      const columnas = window.innerWidth < 600 ? 1 : window.innerWidth < 900 ? 2 : 3;
      galeria.style.gridTemplateColumns = `repeat(${columnas}, 1fr)`;
    }
  }

  window.addEventListener('resize', ajustarGaleria);
  ajustarGaleria(); // Ejecutar al inicio

  // Animaciones al hacer scroll
  const elementosAnimables = document.querySelectorAll('section, .gallery img, form, .card, .proyecto');
  const observer = new IntersectionObserver(entradas => {
    entradas.forEach(entrada => {
      if (entrada.isIntersecting) {
        entrada.target.classList.add('visible');
      }
    });
  }, { threshold: 0.15 });

  elementosAnimables.forEach(el => observer.observe(el));

  // ConfirmaciÃ³n visual al enviar formulario
  const form = document.querySelector('form');
  if (form) {
    form.addEventListener('submit', () => {
      setTimeout(() => {
        alert('ðŸŽ¨ Â¡Gracias por tu encargo! Te contactaremos pronto.');
      }, 500);
    });
  }
});
